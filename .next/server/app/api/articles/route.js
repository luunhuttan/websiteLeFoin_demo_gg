"use strict";(()=>{var e={};e.id=9573,e.ids=[9573],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},34668:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>m,originalPathname:()=>f,patchFetch:()=>h,requestAsyncStorage:()=>d,routeModule:()=>u,serverHooks:()=>p,staticGenerationAsyncStorage:()=>g,staticGenerationBailout:()=>y});var a={};r.r(a),r.d(a,{GET:()=>c,POST:()=>l});var i=r(95419),n=r(69108),s=r(99678),o=r(19631);async function l(e){try{console.log("POST /api/articles called");let{title:t,content:r,tags:a}=await e.json();if(console.log("Request body:",{title:t,content:r,tags:a}),!t||!r)return new Response(JSON.stringify({error:"Missing title or content"}),{status:400});let i=Array.isArray(a)?a:a?[a]:[],n=await o.Z.article.create({data:{title:t,content:r,authorId:1}});if(i.length>0)for(let e of i){let t=await o.Z.tag.findUnique({where:{name:e}});t||(t=await o.Z.tag.create({data:{name:e}})),await o.Z.articletag.create({data:{articleId:n.id,tagId:t.id}})}let s=await o.Z.article.findUnique({where:{id:n.id},include:{articletag:{include:{tag:!0}}}}),l=(s?.articletag||[]).map(e=>({name:e.tag.name}));return new Response(JSON.stringify({id:s?.id,title:s?.title,content:s?.content,createdAt:s?.createdAt,tags:l}),{status:201})}catch(e){return console.error("Error creating article:",e),new Response(JSON.stringify({error:"Internal server error"}),{status:500})}}async function c(){try{console.log("GET /api/articles called");let e=await o.Z.article.findMany({orderBy:{createdAt:"desc"},include:{user:!0,articletag:{include:{tag:!0}}}});console.log("Found articles:",e.length);let t=Array.isArray(e)?e.map(e=>({...e,author:e.user?{id:e.user.id,email:e.user.email}:null,tags:Array.isArray(e.articletag)?e.articletag.map(e=>({name:e.tag?.name})):[]})):[];return new Response(JSON.stringify(t),{status:200})}catch(e){return console.error("Error fetching articles:",e),new Response(JSON.stringify({error:"Internal server error"}),{status:500})}}let u=new i.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/articles/route",pathname:"/api/articles",filename:"route",bundlePath:"app/api/articles/route"},resolvedPagePath:"D:\\websiteLeFoin_demo_gg\\src\\app\\api\\articles\\route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:d,staticGenerationAsyncStorage:g,serverHooks:p,headerHooks:m,staticGenerationBailout:y}=u,f="/api/articles/route";function h(){return(0,s.patchFetch)({serverHooks:p,staticGenerationAsyncStorage:g})}},95419:(e,t,r)=>{e.exports=r(30517)},19631:(e,t,r)=>{r.d(t,{Z:()=>n,_:()=>i});let a=require("@prisma/client"),i=globalThis.prisma??new a.PrismaClient,n=i}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[1638],()=>r(34668));module.exports=a})();
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[594],{7373:function(e,t,a){Promise.resolve().then(a.bind(a,2460))},2460:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return C}});var r=a(3827),l=a(4090),n=a(1126),s=a(7907),i=a(6651),o=a(9769),d=a(2169);let c=(0,o.j)("flex w-full rounded-md border border-hazelnut/30 bg-water px-3 py-2 text-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-hazelnut/40 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-leaf/20 focus-visible:border-leaf disabled:cursor-not-allowed disabled:opacity-50",{variants:{variant:{default:"",search:"pl-10"},inputSize:{default:"h-10",sm:"h-9",lg:"h-11"}},defaultVariants:{variant:"default",inputSize:"default"}}),u=l.forwardRef((e,t)=>{let{className:a,variant:l,inputSize:n,type:s,...i}=e;return(0,r.jsx)("input",{type:s,className:(0,d.cn)(c({variant:l,inputSize:n,className:a})),ref:t,...i})});u.displayName="Input";let f=(0,o.j)("flex w-full rounded-md border border-hazelnut/30 bg-water px-3 py-2 text-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-leaf/20 focus-visible:border-leaf disabled:cursor-not-allowed disabled:opacity-50",{variants:{size:{default:"h-10",sm:"h-9",lg:"h-11"}},defaultVariants:{size:"default"}}),m=l.forwardRef((e,t)=>{let{className:a,size:l,...n}=e;return(0,r.jsx)("select",{className:(0,d.cn)(f({size:l,className:a})),ref:t,...n})});m.displayName="Select";var x=a(703),h=a(8792);let g=(0,o.j)("group relative overflow-hidden rounded-lg bg-water shadow-md transition-all hover:shadow-lg",{variants:{variant:{default:"",featured:"md:col-span-2 lg:col-span-3"}},defaultVariants:{variant:"default"}}),p=l.forwardRef((e,t)=>{let{className:a,variant:l,href:n,children:s,...i}=e,o=(0,r.jsx)("div",{ref:t,className:(0,d.cn)(g({variant:l,className:a})),...i,children:s});return n?(0,r.jsx)(h.default,{href:n,children:o}):o});p.displayName="Card",l.forwardRef((e,t)=>{let{className:a,src:l,alt:n,width:s,height:i,...o}=e;return(0,r.jsx)("div",{ref:t,className:(0,d.cn)("relative aspect-[16/9] overflow-hidden",a),...o,children:(0,r.jsx)(x.default,{src:l,alt:n,fill:!s||!i,width:s,height:i,className:"object-cover transition-transform group-hover:scale-105"})})}).displayName="CardImage",l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,r.jsx)("div",{ref:t,className:(0,d.cn)("p-4",a),...l})}).displayName="CardContent",l.forwardRef((e,t)=>{let{className:a,as:l="h3",...n}=e;return(0,r.jsx)(l,{ref:t,className:(0,d.cn)("font-serif text-xl font-bold text-leaf group-hover:text-amber",a),...n})}).displayName="CardTitle",l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,r.jsx)("p",{ref:t,className:(0,d.cn)("mt-2 text-sm text-hazelnut/80",a),...l})}).displayName="CardDescription",l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,r.jsx)("div",{ref:t,className:(0,d.cn)("mt-4 flex items-center gap-4",a),...l})}).displayName="CardFooter";var v=a(6800),b=a(3500),y=a(8472),j=a(9998),N=a(5495);let w=l.forwardRef((e,t)=>{let{className:a,currentPage:l,totalPages:n,onPageChange:s,showFirstLast:o=!0,siblingCount:c=1,...u}=e,{t:f}=(0,N.useLanguage)(),m=(e,t)=>Array.from({length:t-e+1},(t,a)=>e+a),x=(()=>{if(n>c+5+2){let e=Math.max(l-c,1),t=Math.min(l+c,n),a=e>2,r=t<n-1;if(!a&&r)return[...m(1,3+2*c),"...",n];if(a&&!r)return[1,"...",...m(n-(3+2*c)+1,n)];if(a&&r)return[1,"...",...m(e,t),"...",n]}return m(1,n)})();return(0,r.jsxs)("div",{ref:t,className:(0,d.cn)("flex items-center justify-center gap-2",a),...u,children:[o&&(0,r.jsx)(i.z,{variant:"outline",size:"sm",onClick:()=>s(1),disabled:1===l,children:f("pagination.first")}),(0,r.jsx)(i.z,{variant:"outline",size:"sm",onClick:()=>s(l-1),disabled:1===l,children:f("pagination.previous")}),x.map((e,t)=>"..."===e?(0,r.jsx)("span",{className:"flex h-9 w-9 items-center justify-center text-sm text-hazelnut/60",children:"..."},"ellipsis-".concat(t)):(0,r.jsx)(i.z,{variant:l===e?"default":"outline",size:"sm",onClick:()=>s(e),children:e},e)),(0,r.jsx)(i.z,{variant:"outline",size:"sm",onClick:()=>s(l+1),disabled:l===n,children:f("pagination.next")}),o&&(0,r.jsx)(i.z,{variant:"outline",size:"sm",onClick:()=>s(n),disabled:l===n,children:f("pagination.last")})]})});w.displayName="Pagination";var k=a(8009);function C(){let{data:e,status:t}=(0,n.useSession)(),a=(0,s.useRouter)(),[o,d]=(0,l.useState)([]),[c,f]=(0,l.useState)(!0),[x,h]=(0,l.useState)(!1),[g,N]=(0,l.useState)(1),[C,z]=(0,l.useState)(1),[S,R]=(0,l.useState)("all"),[E,A]=(0,l.useState)("");(0,l.useEffect)(()=>{var r;if("loading"!==t){if(!(null==e?void 0:null===(r=e.user)||void 0===r?void 0:r.id)||"admin"!==e.user.role){a.push("/login");return}P()}},[e,t,g,S,E]);let P=async()=>{try{let e=new URLSearchParams({page:g.toString(),limit:"10",..."all"!==S&&{status:S},...E&&{search:E}}),t=await fetch("/api/admin/comments?".concat(e));if(t.ok){let e=await t.json();d(e.comments),z(e.pagination.pages)}}catch(e){console.error("Error fetching comments:",e)}finally{f(!1)}},L=async(e,t)=>{h(!0);try{(await fetch("/api/comments/".concat(e,"/approve"),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({isApproved:t})})).ok?P():k.Am.error("C\xf3 lỗi xảy ra")}catch(e){console.error("Error approving comment:",e),k.Am.error("C\xf3 lỗi xảy ra")}finally{h(!1)}},T=async e=>{if(window.confirm("Bạn c\xf3 chắc muốn x\xf3a b\xecnh luận n\xe0y?")){h(!0);try{(await fetch("/api/comments/".concat(e),{method:"DELETE"})).ok?P():k.Am.error("C\xf3 lỗi xảy ra")}catch(e){console.error("Error deleting comment:",e),k.Am.error("C\xf3 lỗi xảy ra")}finally{h(!1)}}},D=async()=>{h(!0);try{(await fetch("/api/admin/comments/approve-all",{method:"PATCH"})).ok?(k.Am.success("Đ\xe3 duyệt tất cả b\xecnh luận chờ duyệt!"),P()):k.Am.error("C\xf3 lỗi khi duyệt tất cả b\xecnh luận")}catch(e){k.Am.error("C\xf3 lỗi khi duyệt tất cả b\xecnh luận")}finally{h(!1)}},V=e=>new Date(e).toLocaleDateString("vi-VN",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return"loading"===t||c?(0,r.jsx)(b.$,{className:"py-8",children:(0,r.jsx)(v.W,{children:(0,r.jsx)("div",{className:"text-center",children:"Đang tải..."})})}):(0,r.jsx)(b.$,{className:"py-8",children:(0,r.jsx)(v.W,{children:(0,r.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Quản l\xfd b\xecnh luận"}),(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)(i.z,{onClick:D,disabled:x,className:"bg-green-600 hover:bg-green-700 text-white font-semibold px-6 py-2 rounded-lg shadow",children:"Duyệt tất cả"}),(0,r.jsx)(i.z,{onClick:()=>a.push("/admin"),variant:"outline",children:"Quay lại Dashboard"})]})]}),(0,r.jsx)(p,{className:"p-6 mb-6",children:(0,r.jsxs)("div",{className:"flex gap-4 flex-wrap",children:[(0,r.jsx)("div",{className:"flex-1 min-w-64",children:(0,r.jsx)(u,{type:"text",placeholder:"T\xecm kiếm theo nội dung...",value:E,onChange:e=>A(e.target.value)})}),(0,r.jsxs)(m,{value:S,onChange:e=>R(e.target.value),children:[(0,r.jsx)("option",{value:"all",children:"Tất cả"}),(0,r.jsx)("option",{value:"pending",children:"Chờ duyệt"}),(0,r.jsx)("option",{value:"approved",children:"Đ\xe3 duyệt"})]})]})}),(0,r.jsx)("div",{className:"space-y-4",children:0===o.length?(0,r.jsx)(p,{className:"p-6 text-center",children:(0,r.jsx)(y.x,{className:"text-gray-500 dark:text-gray-400",children:"Kh\xf4ng c\xf3 b\xecnh luận n\xe0o"})}):o.map(e=>(0,r.jsx)(p,{className:"p-6",children:(0,r.jsxs)("div",{className:"flex items-start gap-4",children:[(0,r.jsx)(j.q,{src:e.user.avatar,alt:"".concat(e.user.firstName," ").concat(e.user.lastName),className:"w-12 h-12"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,r.jsxs)(y.x,{className:"font-semibold text-amber-600 dark:text-amber-400",children:[e.user.firstName," ",e.user.lastName]}),(0,r.jsx)("span",{className:"px-2 py-1 text-xs bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-300 rounded",children:e.user.role}),(0,r.jsx)(y.x,{className:"text-sm text-gray-500 dark:text-gray-400",children:V(e.createdAt)}),e.parent&&(0,r.jsx)("span",{className:"px-2 py-1 text-xs bg-blue-100 text-blue-700 dark:bg-blue-900 dark:text-blue-200 rounded",children:"Trả lời"})]}),(0,r.jsx)(y.x,{className:"text-gray-700 dark:text-gray-300 mb-3",children:e.content}),e.parent&&(0,r.jsx)("div",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded mb-3",children:(0,r.jsxs)(y.x,{className:"text-sm text-gray-600 dark:text-gray-400",children:[(0,r.jsx)("strong",{children:"Trả lời:"})," ",e.parent.content]})}),(0,r.jsx)("div",{className:"flex items-center gap-2 mb-3",children:(0,r.jsxs)(y.x,{className:"text-sm text-gray-500 dark:text-gray-400",children:["B\xe0i viết: ",(0,r.jsx)("a",{href:"/articles/".concat(e.article.id),className:"text-amber-600 hover:text-amber-700 dark:text-amber-400",children:e.article.title})]})}),(0,r.jsxs)("div",{className:"flex gap-2",children:[e.isApproved?(0,r.jsx)(i.z,{onClick:()=>L(e.id,!1),disabled:x,variant:"outline",children:"Bỏ duyệt"}):(0,r.jsx)(i.z,{onClick:()=>L(e.id,!0),disabled:x,className:"bg-green-600 hover:bg-green-700",children:"Duyệt"}),(0,r.jsx)(i.z,{onClick:()=>T(e.id),disabled:x,variant:"outline",className:"text-red-600 border-red-600 hover:bg-red-50 dark:hover:bg-red-900/20",children:"X\xf3a"})]})]})]})},e.id))}),C>1&&(0,r.jsx)("div",{className:"mt-6 flex justify-center",children:(0,r.jsx)(w,{currentPage:g,totalPages:C,onPageChange:N})})]})})})}},5495:function(e,t,a){"use strict";a.r(t),a.d(t,{LanguageProvider:function(){return o},useLanguage:function(){return d}});var r=a(3827),l=a(4090);let n=(0,l.createContext)(void 0),s={vi:()=>a.e(360).then(a.t.bind(a,5730,19)).then(e=>e.default),en:()=>a.e(121).then(a.t.bind(a,5121,19)).then(e=>e.default)},i={vi:null,en:null};function o(e){let{children:t}=e,[a,o]=(0,l.useState)("vi"),[d,c]=(0,l.useState)({}),[u,f]=(0,l.useState)(!0),[m,x]=(0,l.useState)(!1);return(0,l.useEffect)(()=>{x(!0)},[]),(0,l.useEffect)(()=>{(async()=>{if(m){f(!0);try{if(i[a]){c(i[a]),f(!1);return}let e=await s[a]();i[a]=e,c(e)}catch(e){console.error("Failed to load translations:",e)}finally{f(!1)}}})()},[a,m]),(0,l.useEffect)(()=>{if(m){let e=localStorage.getItem("locale");e&&("vi"===e||"en"===e)&&o(e)}},[m]),(0,l.useEffect)(()=>{m&&(async()=>{try{let[e,t]=await Promise.all([s.vi(),s.en()]);i.vi=e,i.en=t}catch(e){console.error("Failed to preload translations:",e)}})()},[m]),(0,r.jsx)(n.Provider,{value:{locale:a,setLocale:e=>{o(e),m&&localStorage.setItem("locale",e)},t:e=>!m||u?e:d[e]||e,isLoading:u},children:t})}function d(){let e=(0,l.useContext)(n);if(void 0===e)throw Error("useLanguage must be used within a LanguageProvider");return e}},9998:function(e,t,a){"use strict";a.d(t,{q:function(){return d}});var r=a(3827),l=a(4090),n=a(703),s=a(9769),i=a(2169);let o=(0,s.j)("relative flex shrink-0 overflow-hidden rounded-full",{variants:{size:{sm:"h-8 w-8",default:"h-10 w-10",lg:"h-12 w-12",xl:"h-16 w-16"}},defaultVariants:{size:"default"}}),d=l.forwardRef((e,t)=>{let{className:a,size:l,src:s,alt:d,fallback:c,...u}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)(o({size:l,className:a})),...u,children:s?(0,r.jsx)(n.default,{src:s,alt:d||"",fill:!0,className:"object-cover"}):(0,r.jsx)("div",{className:"flex h-full w-full items-center justify-center bg-leaf/10 text-leaf",children:c?(0,r.jsx)("span",{className:"text-sm font-medium",children:c.slice(0,2).toUpperCase()}):(0,r.jsx)("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})})})});d.displayName="Avatar"},6651:function(e,t,a){"use strict";a.d(t,{z:function(){return d}});var r=a(3827),l=a(4090),n=a(8792),s=a(9769),i=a(2169);let o=(0,s.j)("inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-leaf/20 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-amber text-white hover:bg-goldenSand",outline:"border border-leaf text-leaf hover:bg-leaf hover:text-water",ghost:"text-leaf hover:bg-leaf/10",link:"text-amber underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 px-3",lg:"h-11 px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=l.forwardRef((e,t)=>{let{className:a,variant:l,size:s,asChild:d=!1,href:c,...u}=e;if(d&&c){let{href:e,...t}={...u,className:(0,i.cn)(o({variant:l,size:s,className:a}))};return(0,r.jsx)(n.default,{href:c,...t})}return(0,r.jsx)("button",{ref:t,className:(0,i.cn)(o({variant:l,size:s,className:a})),...u})});d.displayName="Button"},6800:function(e,t,a){"use strict";a.d(t,{W:function(){return s}});var r=a(3827),l=a(4090),n=a(2169);let s=l.forwardRef((e,t)=>{let{className:a,size:l="default",...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("mx-auto w-full px-4 sm:px-6 lg:px-8",{default:"max-w-7xl",sm:"max-w-3xl",lg:"max-w-5xl",fluid:"max-w-full"}[l],a),...s})});s.displayName="Container"},3500:function(e,t,a){"use strict";a.d(t,{$:function(){return s}});var r=a(3827),l=a(4090),n=a(2169);let s=l.forwardRef((e,t)=>{let{className:a,size:l="default",background:s="default",...i}=e;return(0,r.jsx)("section",{ref:t,className:(0,n.cn)({default:"py-12 md:py-16 lg:py-20",sm:"py-8 md:py-12 lg:py-16",lg:"py-16 md:py-20 lg:py-24"}[l],{default:"bg-water",straw:"bg-goldenSand",cream:"bg-lightTeal"}[s],a),...i})});s.displayName="Section"},8472:function(e,t,a){"use strict";a.d(t,{x:function(){return o}});var r=a(3827),l=a(4090),n=a(9769),s=a(2169);let i=(0,n.j)("text-brown",{variants:{size:{xs:"text-xs",sm:"text-sm",base:"text-base",lg:"text-lg",xl:"text-xl","2xl":"text-2xl"},weight:{normal:"font-normal",medium:"font-medium",semibold:"font-semibold",bold:"font-bold"},align:{left:"text-left",center:"text-center",right:"text-right"},textColor:{default:"text-brown",muted:"text-brown/60",olive:"text-olive",moss:"text-moss"}},defaultVariants:{size:"base",weight:"normal",align:"left",textColor:"default"}}),o=l.forwardRef((e,t)=>{let{className:a,size:l,weight:n,align:o,textColor:d,as:c="p",...u}=e;return(0,r.jsx)(c,{ref:t,className:(0,s.cn)(i({size:l,weight:n,align:o,textColor:d,className:a})),...u})});o.displayName="Text"},2169:function(e,t,a){"use strict";a.d(t,{cn:function(){return n}});var r=a(3167),l=a(1367);function n(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,l.m6)((0,r.W)(t))}}},function(e){e.O(0,[267,9,792,703,504,971,69,744],function(){return e(e.s=7373)}),_N_E=e.O()}]);